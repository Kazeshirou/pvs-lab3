\documentclass[a4paper,12pt]{article}

\input{header.tex}

\title{Отчёт по лабораторной работе \\ <<Механизмы протокола TCP>>}
\author{Жаровой Наталии Александровны}

\begin{document}

\maketitle

\tableofcontents

% Текст отчёта должен быть читаемым!!! Написанное здесь является рыбой.

\section{Однопоточный чат на select}

Код сервера. 
\input{includes/echo_server.tex}

Код клиента. 
\input{includes/echo_client.tex}


\section{Установка и разрыв соединения}

С c1 (10.10.0.2) подключаемся к c6 (10.50.0.2), отсылаем несколько строчек и разрываем соединение.

\begin{Verbatim}
c1:~# telnet 10.50.0.2 9
Trying 10.50.0.2...
Connected to 10.50.0.2.
Escape character is '^]'.
one
two
three
^]
telnet> q
Connection closed.
\end{Verbatim}

Дамп с c2 (10.10.0.1).

\begin{Verbatim}
c2:~# tcpdump -n -i eth0 tcp
listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes
20:38:48.288032 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    S 3914370038:3914370038(0) win 5840 <mss 1460,sackOK,timestamp 330821 0,nop,wscale 1>
20:38:48.327241 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    S 3918055579:3918055579(0) ack 3914370039 win 5792 
        <mss 536,sackOK,timestamp 330395 330821,nop,wscale 1>
20:38:48.327516 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    . ack 1 win 2920 <nop,nop,timestamp 330832 330395>
20:39:09.999603 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    P 1:6(5) ack 1 win 2920 <nop,nop,timestamp 333001 330395>
20:39:10.000808 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    . ack 6 win 2896 <nop,nop,timestamp 332562 333001>
20:39:11.971356 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    P 6:11(5) ack 1 win 2920 <nop,nop,timestamp 333198 332562>
20:39:11.972405 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    . ack 11 win 2896 <nop,nop,timestamp 332759 333198>
20:39:14.441228 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    P 11:18(7) ack 1 win 2920 <nop,nop,timestamp 333445 332759>
20:39:14.442558 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    . ack 18 win 2896 <nop,nop,timestamp 333006 333445>
20:39:29.859443 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    F 18:18(0) ack 1 win 2920 <nop,nop,timestamp 334987 333006>
20:39:29.863838 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    F 1:1(0) ack 19 win 2896 <nop,nop,timestamp 334549 334987>
20:39:29.864247 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    . ack 2 win 2920 <nop,nop,timestamp 334987 334549>
\end{Verbatim}

Дамп с c3 (10.20.0.2).

\begin{Verbatim}
c3:~# tcpdump -n -i eth0 tcp
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes
20:38:48.305310 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    S 3914370038:3914370038(0) win 5840 <mss 1460,sackOK,timestamp 330821 0,nop,wscale 1>
20:38:48.329652 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    S 3918055579:3918055579(0) ack 3914370039 win 5792 
        <mss 536,sackOK,timestamp 330395 330821,nop,wscale 1>
20:38:48.330318 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    . ack 1 win 2920 <nop,nop,timestamp 330832 330395>
20:39:10.002470 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    P 1:6(5) ack 1 win 2920 <nop,nop,timestamp 333001 330395>
20:39:10.003230 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    . ack 6 win 2896 <nop,nop,timestamp 332562 333001>
20:39:11.974239 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    P 6:11(5) ack 1 win 2920 <nop,nop,timestamp 333198 332562>
20:39:11.974948 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    . ack 11 win 2896 <nop,nop,timestamp 332759 333198>
20:39:14.444132 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    P 11:18(7) ack 1 win 2920 <nop,nop,timestamp 333445 332759>
20:39:14.445051 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    . ack 18 win 2896 <nop,nop,timestamp 333006 333445>
20:39:29.862280 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    F 18:18(0) ack 1 win 2920 <nop,nop,timestamp 334987 333006>
20:39:29.866328 IP 10.50.0.2.9 > 10.10.0.2.58443: 
    F 1:1(0) ack 19 win 2896 <nop,nop,timestamp 334549 334987>
20:39:29.867042 IP 10.10.0.2.58443 > 10.50.0.2.9: 
    . ack 2 win 2920 <nop,nop,timestamp 334987 334549>
\end{Verbatim}

\section{Окно получателя}

На с4 (10.30.0.2) запущена программа win: 
\begin{Verbatim}
./win 3002 2 1
\end{Verbatim}

На c1 (10.10.0.2) : 
\begin{Verbatim}
c1:~# netcat 10.30.0.2 3002 < /dev/zero
\end{Verbatim}

Дамп с c3 (10.20.0.2).

%окно получателя до нуля
\begin{Verbatim}
c3:~# tcpdump -n -i eth0 tcp
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 96 bytes
09:01:35.790361 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    S 693180048:693180048(0) win 5840 <mss 1460,sackOK,timestamp 4787572 0,nop,wscale 1>
09:01:35.800103 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    S 695349641:695349641(0) ack 693180049 win 2096 
        <mss 536,sackOK,timestamp 4787260 4787572,nop,wscale 1>
09:01:35.801026 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.801330 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 1:525(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.801417 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 525:1049(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.801525 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 525 win 1572 <nop,nop,timestamp 4787260 4787580>
09:01:35.801558 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 1049 win 2096 <nop,nop,timestamp 4787260 4787580>
09:01:35.801948 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 1049:1573(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.802026 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 1573:2097(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.802112 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 2097:2621(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.802121 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 2621:3145(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.802162 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 1573 win 2620 <nop,nop,timestamp 4787260 4787580>
09:01:35.802219 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 2097 win 3144 <nop,nop,timestamp 4787260 4787580>
09:01:35.802227 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 2621 win 3668 <nop,nop,timestamp 4787260 4787580>
09:01:35.802251 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 3145 win 4192 <nop,nop,timestamp 4787260 4787580>
09:01:35.802742 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 3145:3669(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.802764 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 3669:4193(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.802999 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 4193:4717(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.803035 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 3669 win 4716 <nop,nop,timestamp 4787260 4787580>
09:01:35.803051 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 4193 win 5240 <nop,nop,timestamp 4787260 4787580>
09:01:35.803184 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 4717 win 5764 <nop,nop,timestamp 4787260 4787580>
09:01:35.803763 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 4717:5241(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.803786 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 5241:5765(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.803822 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 5765:6289(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.803831 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 6289:6813(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.803838 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 6813:7337(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.803985 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 5241 win 6288 <nop,nop,timestamp 4787260 4787580>
09:01:35.804000 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 5765 win 6812 <nop,nop,timestamp 4787260 4787580>
09:01:35.804034 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 6289 win 7336 <nop,nop,timestamp 4787260 4787580>
09:01:35.804042 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 6813 win 7860 <nop,nop,timestamp 4787260 4787580>
09:01:35.804050 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 7337 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.804519 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 7337:7861(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804535 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 7861:8385(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804544 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 8385:8909(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804552 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 8909:9433(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804560 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 9433:9957(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804567 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 9957:10481(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804631 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 10481:11005(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804670 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 11005:11529(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804756 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 11529:12053(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804797 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 12053:12577(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804829 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 12577:13101(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804837 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 13101:13625(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804865 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 13625:14149(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804873 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 14149:14673(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804903 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 14673:15197(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.804912 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 15197:15721(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.805255 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 7861 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.805280 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 8385 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.805289 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 9433 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.805331 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 10481 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.805339 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 11529 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.805347 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 12577 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.805355 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 13625 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.805363 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 14673 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.805386 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 15721 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.806023 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 15721:16245(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806061 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 16245:16769(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806090 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 16769:17293(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806099 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 17293:17817(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806126 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 17817:18341(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806134 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 18341:18865(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806162 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 18865:19389(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806170 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 19389:19913(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806197 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 19913:20437(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806205 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 20437:20961(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806232 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 20961:21485(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806240 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 21485:22009(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806268 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 22009:22533(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806276 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 22533:23057(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806303 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 23057:23581(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806311 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 23581:24105(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806335 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 24105:24577(472) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.806785 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 16769 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.806798 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 17817 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.806806 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 18865 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.806832 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 24577:25101(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.807150 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 25101:25625(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.807193 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 25625:26149(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.807260 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 26149:26673(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.807812 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 26673:27197(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808014 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 27197:27721(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808199 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 27721:28245(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808213 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 28245:28769(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808222 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 28769:29293(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808250 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 27721 win 3956 <nop,nop,timestamp 4787260 4787580>
09:01:35.808439 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 28245 win 3694 <nop,nop,timestamp 4787260 4787580>
09:01:35.808454 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 28769 win 3432 <nop,nop,timestamp 4787260 4787580>
09:01:35.808462 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 29293 win 3170 <nop,nop,timestamp 4787260 4787580>
09:01:35.808524 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 29293:29817(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808557 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 29817:30341(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808580 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 30341:30865(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808603 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 30865:31389(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808632 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 31389:31913(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808640 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 31913:32437(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.808832 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 29817 win 3144 <nop,nop,timestamp 4787260 4787580>
09:01:35.808850 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 30341 win 3668 <nop,nop,timestamp 4787260 4787580>
09:01:35.808858 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 30865 win 4192 <nop,nop,timestamp 4787260 4787580>
09:01:35.808867 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 31389 win 4716 <nop,nop,timestamp 4787260 4787580>
09:01:35.808896 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 31913 win 5240 <nop,nop,timestamp 4787260 4787580>
09:01:35.808904 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 32437 win 5764 <nop,nop,timestamp 4787260 4787580>
09:01:35.809070 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 32437:32961(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.809282 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 32961 win 6288 <nop,nop,timestamp 4787260 4787580>
09:01:35.809344 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 32961:33485(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.809438 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 33485:34009(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.809478 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 34009:34533(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.809487 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 34533:35057(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.809508 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 35057:35581(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.809687 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 33485 win 6812 <nop,nop,timestamp 4787260 4787580>
09:01:35.809702 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 34009 win 7336 <nop,nop,timestamp 4787260 4787580>
09:01:35.809731 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 34533 win 7860 <nop,nop,timestamp 4787260 4787580>
09:01:35.809739 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 35057 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.809929 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 35581:36105(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.810093 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 36105 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.810173 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 36105:36629(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.810205 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 36629:37153(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.810239 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 37153:37677(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811161 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 37677:38201(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811191 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 38201:38725(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811327 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 38725:39249(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811348 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 39249:39773(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811389 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 39773:40297(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811398 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 40297:40821(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811406 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 40821:41345(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811413 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 41345:41869(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811452 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 41869:42393(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811461 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 42393:42917(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811468 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 42917:43441(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811480 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 37153 win 8384 <nop,nop,timestamp 4787260 4787580>
09:01:35.811516 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 43441:43965(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811525 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 43965:44489(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811533 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 44489:45013(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811541 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 45013:45537(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811582 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 45537:46061(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811591 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 46061:46585(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811599 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 46585:47109(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811606 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 47109:47633(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811645 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 47633:48157(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811654 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 48157:48681(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811662 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 48681:49205(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811669 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 49205:49729(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811703 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 49729:50253(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811711 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 50253:50777(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811719 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 50777:51301(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811752 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 51301:51825(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811762 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 51825:52349(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.811770 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 52349:52873(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.812505 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 52873:53397(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.812528 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 53397:53921(524) ack 1 win 2920 <nop,nop,timestamp 4787580 4787260>
09:01:35.837756 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 53921 win 4118 <nop,nop,timestamp 4787264 4787580>
09:01:35.838777 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 53921:54445(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838803 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 54445:54969(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838812 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 54969:55493(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838820 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 55493:56017(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838827 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 56017:56541(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838835 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 56541:57065(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838843 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 57065:57589(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838850 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 57589:58113(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838858 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 58113:58637(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838866 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 58637:59161(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838874 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 59161:59685(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838882 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 59685:60209(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838890 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 60209:60733(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838897 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 60733:61257(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.838904 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 61257:61781(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.839346 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 61781 win 4192 <nop,nop,timestamp 4787264 4787583>
09:01:35.839997 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 61781:62305(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840152 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 62305:62829(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840185 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 62829:63353(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840220 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 63353:63877(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840257 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 63877:64401(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840834 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 64401:64925(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840851 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 64925:65449(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840859 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 65449:65973(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840867 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 65973:66497(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840875 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 66497:67021(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840883 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 67021:67545(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840890 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 67545:68069(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840898 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 68069:68593(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840905 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 68593:69117(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840913 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 69117:69641(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840920 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 69641:70165(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.840933 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 62305 win 4256 <nop,nop,timestamp 4787264 4787583>
09:01:35.841528 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 70165:70689(524) ack 1 win 2920 <nop,nop,timestamp 4787583 4787264>
09:01:35.877783 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 70689 win 794 <nop,nop,timestamp 4787268 4787583>
09:01:35.878704 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 70689:71213(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.878741 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 71213:71737(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.878752 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 71737:72261(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.879131 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 72261 win 1048 <nop,nop,timestamp 4787268 4787587>
09:01:35.879746 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 72261:72785(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.879776 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 72785:73309(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.879811 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 73309:73833(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.879821 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 73833:74357(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.880428 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 72785 win 1572 <nop,nop,timestamp 4787268 4787587>
09:01:35.880447 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 73309 win 1970 <nop,nop,timestamp 4787268 4787587>
09:01:35.881149 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 74357:74881(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.881187 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 74881:75405(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.881197 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 75405:75929(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.881235 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 75929:76453(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.881245 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 76453:76977(524) ack 1 win 2920 <nop,nop,timestamp 4787587 4787268>
09:01:35.917765 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 76977 win 464 <nop,nop,timestamp 4787272 4787587>
09:01:35.918741 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . 76977:77501(524) ack 1 win 2920 <nop,nop,timestamp 4787591 4787272>
09:01:35.957787 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 77501 win 202 <nop,nop,timestamp 4787276 4787591>
09:01:36.170899 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    P 77501:77905(404) ack 1 win 2920 <nop,nop,timestamp 4787617 4787276>
09:01:36.171322 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 77905 win 0 <nop,nop,timestamp 4787297 4787617>
09:01:36.390859 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . ack 1 win 2920 <nop,nop,timestamp 4787639 4787297>
09:01:36.391388 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 77905 win 0 <nop,nop,timestamp 4787319 4787617>
09:01:36.830831 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . ack 1 win 2920 <nop,nop,timestamp 4787683 4787319>
09:01:36.831371 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 77905 win 0 <nop,nop,timestamp 4787363 4787617>
09:01:37.710769 IP 10.10.0.2.50830 > 10.30.0.2.3002: 
    . ack 1 win 2920 <nop,nop,timestamp 4787771 4787363>
09:01:37.711305 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    . ack 77905 win 0 <nop,nop,timestamp 4787451 4787617>
09:01:37.809235 IP 10.30.0.2.3002 > 10.10.0.2.50830: 
    R 1:1(0) ack 77905 win 1572 <nop,nop,timestamp 4787461 4787617>
\end{Verbatim}

\section{Окно отправителя}

Где что дампим.

\begin{Verbatim}
окно отправителя растёт и растёт
\end{Verbatim}

\section{Нейгл и Мишналь}

Где что дампим.  Дампить без -t обязательно!
Мы должны увидеть, что мы посылаем неполный сегмент, как только подтверждены все неполные сегменты (даже если полные не подтверждены).

\begin{Verbatim}
увидеть хотя бы нейгла
\end{Verbatim}

\section{Аггрессивная буферизация}

Где что дампим.  Дампить без -t обязательно!

\begin{Verbatim}
cork
\end{Verbatim}

\section{Отправка без задержки}

Где что дампим.  Дампить без -t обязательно!

\begin{Verbatim}
увидеть, что nodelay не помогает, когда окно отправителя полное
\end{Verbatim}

\section{Быстрый повтор}

Где что дампим.  Дампить без -t обязательно!

\begin{Verbatim}
увидеть быстрый повтор
\end{Verbatim}

\section{Обычный повтор}

Где что дампим. Дампить без -t обязательно!

\begin{Verbatim}
увидеть не-быстрый повтор
\end{Verbatim}

\section{Опыт с PMTU}

Для опыта нужно на c3 и c4 отключить tcpclump.
Надеюсь тут поможет команда iptables -F.
Для сброса кеша MSS на с1 его можно тупо перегрузить.

После этих подготовительных действий мы наверное увидим pmtu в действии при попытке соединится с c1 на c6.

\begin{Verbatim}
Дампить (tcp or icmp) на c2 eth0.
\end{Verbatim}

\section{Соединение с неверным портом}

Что будет, если клиент пытается соединиться с портом, который не слушвет сервер.

\begin{Verbatim}
Дампить
\end{Verbatim}

\end{document}
